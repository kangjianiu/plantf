[2025-07-01 11:04:12,399][__main__][INFO] - Logger is configured correctly.
[2025-07-01 11:04:12,505][nuplan.planning.script.builders.folder_builder][INFO] - Building experiment folders...
[2025-07-01 11:04:12,506][nuplan.planning.script.builders.folder_builder][INFO] - Experimental folder: /data/datasets/niukangjia/plantf/output/training/planTF/2025.07.01.11.04.10
[2025-07-01 11:04:12,506][nuplan.planning.script.builders.worker_pool_builder][INFO] - Building WorkerPool...
[2025-07-01 11:04:12,507][nuplan.planning.utils.multithreading.worker_pool][INFO] - Worker: SingleMachineParallelExecutor
[2025-07-01 11:04:12,507][nuplan.planning.utils.multithreading.worker_pool][INFO] - Number of nodes: 1
Number of CPUs per node: 32
Number of GPUs per node: 0
Number of threads across all nodes: 32
[2025-07-01 11:04:12,507][nuplan.planning.script.builders.worker_pool_builder][INFO] - Building WorkerPool...DONE!
[2025-07-01 11:04:12,507][src.custom_training.custom_training_builder][INFO] - Building training engine...
[2025-07-01 11:04:12,592][nuplan.planning.script.builders.model_builder][INFO] - Building TorchModuleWrapper...
[2025-07-01 11:04:13,270][src.models.planTF.diffusion_modelv3][INFO] - nkj diffusion modelv3 num_modes:80
[2025-07-01 11:04:13,289][src.models.planTF.planning_model][INFO] - nkj planning model num_modes:80
[2025-07-01 11:04:13,289][nuplan.planning.script.builders.model_builder][INFO] - Building TorchModuleWrapper...DONE!
[2025-07-01 11:04:13,289][nuplan.planning.script.builders.splitter_builder][INFO] - Building Splitter...
[2025-07-01 11:04:14,136][nuplan.planning.script.builders.splitter_builder][INFO] - Building Splitter...DONE!
[2025-07-01 11:04:14,136][nuplan.planning.script.builders.data_augmentation_builder][INFO] - Building augmentors...
[2025-07-01 11:04:14,139][nuplan.planning.script.builders.data_augmentation_builder][INFO] - Building augmentors...DONE!
[2025-07-01 11:04:26,909][nuplan.planning.script.builders.scenario_builder][INFO] - Extracted 204791 scenarios for training
[2025-07-01 11:04:26,913][__main__][INFO] - Starting training...
[2025-07-01 11:04:26,916][torch.distributed.distributed_c10d][INFO] - Added key: store_based_barrier_key:1 to store for rank: 0
[2025-07-01 11:04:26,917][torch.distributed.distributed_c10d][INFO] - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
[2025-07-01 11:04:28,305][src.custom_training.custom_datamodule][INFO] - Number of samples in train set: 132384
[2025-07-01 11:04:28,362][src.custom_training.custom_datamodule][INFO] - Number of samples in validation set: 32407
[2025-07-01 11:04:32,270][root][INFO] - 
[Epoch 0] val_loss: 3.749, val_reg_loss: 3.845, val_cls_loss: 4.382, val_pred_losss: 3.097, val_MR: 0.562, val_minADE1: 14.983, val_minADE6: 14.951, val_minFDE1: 29.188, val_minFDE6: 29.090
[2025-07-01 13:53:28,406][root][INFO] - 
[Epoch 0] val_loss: 2.838, val_reg_loss: 2.771, val_cls_loss: 4.082, val_pred_losss: 2.451, val_MR: 0.547, val_minADE1: 14.294, val_minADE6: 11.219, val_minFDE1: 29.783, val_minFDE6: 24.634
[2025-07-01 13:53:28,413][root][INFO] - 
[Epoch 0] train_loss: 3.341, train_reg_loss: 3.275, train_cls_loss: 4.130, train_pred_losss: 3.178, train_MR: 0.563, train_minADE1: 15.432, train_minADE6: 12.641, train_minFDE1: 30.945, train_minFDE6: 27.593
[2025-07-01 16:42:27,045][root][INFO] - 
[Epoch 1] val_loss: 1.709, val_reg_loss: 1.261, val_cls_loss: 4.253, val_pred_losss: 2.003, val_MR: 0.455, val_minADE1: 8.602, val_minADE6: 6.241, val_minFDE1: 21.175, val_minFDE6: 16.618
[2025-07-01 16:42:27,054][root][INFO] - 
[Epoch 1] train_loss: 2.495, train_reg_loss: 2.193, train_cls_loss: 4.157, train_pred_losss: 2.724, train_MR: 0.480, train_minADE1: 12.515, train_minADE6: 9.083, train_minFDE1: 27.349, train_minFDE6: 20.424
[2025-07-01 19:31:42,548][root][INFO] - 
[Epoch 2] val_loss: 0.825, val_reg_loss: 0.201, val_cls_loss: 4.103, val_pred_losss: 1.370, val_MR: 0.155, val_minADE1: 10.186, val_minADE6: 2.660, val_minFDE1: 20.112, val_minFDE6: 5.691
[2025-07-01 19:31:42,557][root][INFO] - 
[Epoch 2] train_loss: 1.477, train_reg_loss: 0.881, train_cls_loss: 4.295, train_pred_losss: 2.155, train_MR: 0.352, train_minADE1: 11.007, train_minADE6: 5.335, train_minFDE1: 23.536, train_minFDE6: 12.034
[2025-07-01 22:20:28,259][root][INFO] - 
[Epoch 3] val_loss: 0.663, val_reg_loss: 0.124, val_cls_loss: 4.155, val_pred_losss: 0.802, val_MR: 0.080, val_minADE1: 5.866, val_minADE6: 2.066, val_minFDE1: 13.766, val_minFDE6: 4.305
[2025-07-01 22:20:28,267][root][INFO] - 
[Epoch 3] train_loss: 0.904, train_reg_loss: 0.249, train_cls_loss: 4.319, train_pred_losss: 1.487, train_MR: 0.195, train_minADE1: 9.812, train_minADE6: 3.438, train_minFDE1: 18.631, train_minFDE6: 6.262
[2025-07-02 01:09:37,130][root][INFO] - 
[Epoch 4] val_loss: 0.632, val_reg_loss: 0.107, val_cls_loss: 4.385, val_pred_losss: 0.593, val_MR: 0.074, val_minADE1: 8.718, val_minADE6: 2.097, val_minFDE1: 17.357, val_minFDE6: 3.658
[2025-07-02 01:09:37,138][root][INFO] - 
[Epoch 4] train_loss: 0.748, train_reg_loss: 0.162, train_cls_loss: 4.303, train_pred_losss: 1.022, train_MR: 0.137, train_minADE1: 9.269, train_minADE6: 3.202, train_minFDE1: 18.360, train_minFDE6: 6.097
[2025-07-02 03:58:14,283][root][INFO] - 
[Epoch 5] val_loss: 0.599, val_reg_loss: 0.095, val_cls_loss: 4.292, val_pred_losss: 0.514, val_MR: 0.075, val_minADE1: 7.245, val_minADE6: 2.661, val_minFDE1: 15.951, val_minFDE6: 5.420
[2025-07-02 03:58:14,292][root][INFO] - 
[Epoch 5] train_loss: 0.695, train_reg_loss: 0.146, train_cls_loss: 4.292, train_pred_losss: 0.817, train_MR: 0.121, train_minADE1: 8.281, train_minADE6: 3.306, train_minFDE1: 16.639, train_minFDE6: 6.275
[2025-07-02 06:47:18,439][root][INFO] - 
[Epoch 6] val_loss: 0.588, val_reg_loss: 0.080, val_cls_loss: 4.294, val_pred_losss: 0.513, val_MR: 0.062, val_minADE1: 4.984, val_minADE6: 1.742, val_minFDE1: 10.034, val_minFDE6: 3.122
[2025-07-02 06:47:18,447][root][INFO] - 
[Epoch 6] train_loss: 0.667, train_reg_loss: 0.134, train_cls_loss: 4.280, train_pred_losss: 0.728, train_MR: 0.107, train_minADE1: 7.823, train_minADE6: 3.191, train_minFDE1: 15.832, train_minFDE6: 6.184
[2025-07-02 09:35:51,719][root][INFO] - 
[Epoch 7] val_loss: 0.583, val_reg_loss: 0.087, val_cls_loss: 4.299, val_pred_losss: 0.458, val_MR: 0.072, val_minADE1: 4.679, val_minADE6: 2.370, val_minFDE1: 9.671, val_minFDE6: 4.363
[2025-07-02 09:35:51,728][root][INFO] - 
[Epoch 7] train_loss: 0.650, train_reg_loss: 0.124, train_cls_loss: 4.284, train_pred_losss: 0.672, train_MR: 0.094, train_minADE1: 7.332, train_minADE6: 3.002, train_minFDE1: 14.897, train_minFDE6: 5.758
[2025-07-02 12:25:24,230][root][INFO] - 
[Epoch 8] val_loss: 0.588, val_reg_loss: 0.091, val_cls_loss: 4.333, val_pred_losss: 0.454, val_MR: 0.054, val_minADE1: 6.442, val_minADE6: 4.050, val_minFDE1: 12.607, val_minFDE6: 7.297
[2025-07-02 12:25:24,238][root][INFO] - 
[Epoch 8] train_loss: 0.638, train_reg_loss: 0.117, train_cls_loss: 4.293, train_pred_losss: 0.636, train_MR: 0.085, train_minADE1: 7.007, train_minADE6: 2.909, train_minFDE1: 14.190, train_minFDE6: 5.607
