2025-01-14 14:11:58,038 INFO {/data/datasets/niukangjia/plantf/run_training.py:49}  Logger is configured correctly.
2025-01-14 14:11:58,230 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/script/builders/folder_builder.py:20}  Building experiment folders...
2025-01-14 14:11:58,230 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/script/builders/folder_builder.py:22}  Experimental folder: /data/datasets/niukangjia/plantf/output/training/planTF/2025.01.14.14.11.56
2025-01-14 14:11:58,230 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/script/builders/worker_pool_builder.py:19}  Building WorkerPool...
2025-01-14 14:11:58,231 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/utils/multithreading/worker_pool.py:101}  Worker: SingleMachineParallelExecutor
2025-01-14 14:11:58,231 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/utils/multithreading/worker_pool.py:102}  Number of nodes: 1
Number of CPUs per node: 32
Number of GPUs per node: 0
Number of threads across all nodes: 32
2025-01-14 14:11:58,231 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/script/builders/worker_pool_builder.py:27}  Building WorkerPool...DONE!
2025-01-14 14:11:58,232 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_training_builder.py:258}  Building training engine...
2025-01-14 14:12:02,901 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/script/builders/model_builder.py:18}  Building TorchModuleWrapper...
2025-01-14 14:12:03,908 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/script/builders/model_builder.py:21}  Building TorchModuleWrapper...DONE!
2025-01-14 14:12:03,909 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/script/builders/splitter_builder.py:18}  Building Splitter...
2025-01-14 14:12:04,715 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/script/builders/splitter_builder.py:21}  Building Splitter...DONE!
2025-01-14 14:12:04,715 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/script/builders/data_augmentation_builder.py:19}  Building augmentors...
2025-01-14 14:12:04,718 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/script/builders/data_augmentation_builder.py:28}  Building augmentors...DONE!
2025-01-14 14:12:17,786 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/script/builders/scenario_builder.py:171}  Extracted 204791 scenarios for training
2025-01-14 14:12:17,800 INFO {/data/datasets/niukangjia/plantf/run_training.py:68}  Starting training...
2025-01-14 14:12:17,835 INFO {/home/ustc/anaconda3/envs/pluto/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:442}  Added key: store_based_barrier_key:1 to store for rank: 0
2025-01-14 14:12:17,835 INFO {/home/ustc/anaconda3/envs/pluto/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:476}  Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
2025-01-14 14:12:18,275 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_datamodule.py:56}  Number of samples in train set: 132384
2025-01-14 14:12:18,368 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_datamodule.py:56}  Number of samples in validation set: 32407
2025-01-14 14:12:23,344 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_training_builder.py:318}  
[Epoch 0] val_loss: 7.96571, val_reg_loss: 3.65160, val_cls_loss: 2.47302, val_prediction_losss: 3.35938, val_diffusion_loss: 0.46013, val_MR: 0.50000, val_minADE1: 14.30442, val_minADE6: 14.27697, val_minFDE1: 28.25203, val_minFDE6: 27.99788
2025-01-14 14:29:47,650 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_training_builder.py:318}  
[Epoch 0] val_loss: 7.98081, val_reg_loss: 3.55361, val_cls_loss: 1.04677, val_prediction_losss: 3.05537, val_diffusion_loss: 1.16248, val_MR: 0.70035, val_minADE1: 14.28074, val_minADE6: 13.97097, val_minFDE1: 30.93718, val_minFDE6: 30.68748
2025-01-14 14:47:08,758 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_training_builder.py:318}  
[Epoch 0] val_loss: 7.76308, val_reg_loss: 3.47800, val_cls_loss: 1.34152, val_prediction_losss: 2.76053, val_diffusion_loss: 1.25625, val_MR: 0.70390, val_minADE1: 14.07455, val_minADE6: 13.65677, val_minFDE1: 30.64464, val_minFDE6: 30.27013
2025-01-14 14:47:11,063 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_training_builder.py:318}  
[Epoch 0] train_loss: 7.91200, train_reg_loss: 3.67771, train_cls_loss: 1.08744, train_prediction_losss: 3.46927, train_diffusion_loss: 0.54754, train_MR: 0.59887, train_minADE1: 14.31202, train_minADE6: 13.57706, train_minFDE1: 30.28727, train_minFDE6: 29.40994
2025-01-14 15:04:43,633 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_training_builder.py:318}  
[Epoch 1] val_loss: 7.69581, val_reg_loss: 3.41872, val_cls_loss: 1.34077, val_prediction_losss: 2.59139, val_diffusion_loss: 1.41755, val_MR: 0.71183, val_minADE1: 13.79313, val_minADE6: 13.47150, val_minFDE1: 30.40414, val_minFDE6: 30.16806
2025-01-14 15:22:22,297 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_training_builder.py:318}  
[Epoch 1] val_loss: 7.44517, val_reg_loss: 3.25347, val_cls_loss: 1.45884, val_prediction_losss: 2.41955, val_diffusion_loss: 1.48038, val_MR: 0.70241, val_minADE1: 13.03163, val_minADE6: 12.84287, val_minFDE1: 29.39308, val_minFDE6: 29.23607
2025-01-14 15:22:24,107 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_training_builder.py:318}  
[Epoch 1] train_loss: 7.18724, train_reg_loss: 3.47287, train_cls_loss: 0.96713, train_prediction_losss: 3.08850, train_diffusion_loss: 0.43247, train_MR: 0.60041, train_minADE1: 13.48866, train_minADE6: 12.93896, train_minFDE1: 29.24946, train_minFDE6: 28.33237
2025-01-14 15:39:43,902 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_training_builder.py:318}  
[Epoch 2] val_loss: 7.21006, val_reg_loss: 2.92009, val_cls_loss: 1.56026, val_prediction_losss: 2.11108, val_diffusion_loss: 1.86683, val_MR: 0.70031, val_minADE1: 11.65175, val_minADE6: 11.53923, val_minFDE1: 28.18052, val_minFDE6: 27.61661
2025-01-14 16:03:13,512 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_training_builder.py:318}  
[Epoch 2] val_loss: 7.00004, val_reg_loss: 2.55549, val_cls_loss: 0.94437, val_prediction_losss: 1.80969, val_diffusion_loss: 2.44600, val_MR: 0.69534, val_minADE1: 10.25519, val_minADE6: 10.05584, val_minFDE1: 25.87030, val_minFDE6: 24.97212
2025-01-14 16:03:15,701 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_training_builder.py:318}  
[Epoch 2] train_loss: 6.34847, train_reg_loss: 3.02851, train_cls_loss: 0.94709, train_prediction_losss: 2.65402, train_diffusion_loss: 0.47653, train_MR: 0.60405, train_minADE1: 11.96093, train_minADE6: 11.35366, train_minFDE1: 27.01201, train_minFDE6: 25.88452
2025-01-14 16:40:21,840 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_training_builder.py:318}  
[Epoch 3] val_loss: 7.01559, val_reg_loss: 2.23241, val_cls_loss: 1.08895, val_prediction_losss: 1.51812, val_diffusion_loss: 3.04727, val_MR: 0.67830, val_minADE1: 8.90931, val_minADE6: 8.73918, val_minFDE1: 23.63031, val_minFDE6: 21.71296
