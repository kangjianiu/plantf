[2025-02-26 16:05:40,843][__main__][INFO] - Logger is configured correctly.
[2025-02-26 16:05:40,961][nuplan.planning.script.builders.folder_builder][INFO] - Building experiment folders...
[2025-02-26 16:05:40,961][nuplan.planning.script.builders.folder_builder][INFO] - Experimental folder: /data/datasets/niukangjia/plantf/output/training/planTF/2025.02.26.16.05.39
[2025-02-26 16:05:40,961][nuplan.planning.script.builders.worker_pool_builder][INFO] - Building WorkerPool...
[2025-02-26 16:05:40,963][nuplan.planning.utils.multithreading.worker_pool][INFO] - Worker: SingleMachineParallelExecutor
[2025-02-26 16:05:40,963][nuplan.planning.utils.multithreading.worker_pool][INFO] - Number of nodes: 1
Number of CPUs per node: 32
Number of GPUs per node: 0
Number of threads across all nodes: 32
[2025-02-26 16:05:40,963][nuplan.planning.script.builders.worker_pool_builder][INFO] - Building WorkerPool...DONE!
[2025-02-26 16:05:40,963][src.custom_training.custom_training_builder][INFO] - Building training engine...
[2025-02-26 16:05:45,865][nuplan.planning.script.builders.model_builder][INFO] - Building TorchModuleWrapper...
[2025-02-26 16:05:46,780][nuplan.planning.script.builders.model_builder][INFO] - Building TorchModuleWrapper...DONE!
[2025-02-26 16:05:46,780][nuplan.planning.script.builders.splitter_builder][INFO] - Building Splitter...
[2025-02-26 16:05:47,977][nuplan.planning.script.builders.splitter_builder][INFO] - Building Splitter...DONE!
[2025-02-26 16:05:47,978][nuplan.planning.script.builders.data_augmentation_builder][INFO] - Building augmentors...
[2025-02-26 16:05:47,982][nuplan.planning.script.builders.data_augmentation_builder][INFO] - Building augmentors...DONE!
[2025-02-26 16:06:03,224][nuplan.planning.script.builders.scenario_builder][INFO] - Extracted 204791 scenarios for training
[2025-02-26 16:06:03,229][__main__][INFO] - Starting training...
[2025-02-26 16:06:03,232][torch.distributed.distributed_c10d][INFO] - Added key: store_based_barrier_key:1 to store for rank: 0
[2025-02-26 16:06:03,232][torch.distributed.distributed_c10d][INFO] - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
[2025-02-26 16:06:04,890][src.custom_training.custom_datamodule][INFO] - Number of samples in train set: 132384
[2025-02-26 16:06:04,963][src.custom_training.custom_datamodule][INFO] - Number of samples in validation set: 32407
[2025-02-26 16:06:25,488][root][INFO] - 
[Epoch 0] val_loss: 7.84127, val_reg_loss: 4.50427, val_cls_loss: 3.74160, val_prediction_losss: 3.29958, val_diffusion_loss: 0.46234, val_MR: 0.68750, val_minADE1: 17.44901, val_minADE6: 17.42274, val_minFDE1: 35.16829, val_minFDE6: 35.05772
[2025-02-26 18:25:30,089][root][INFO] - 
[Epoch 0] val_loss: 6.37203, val_reg_loss: 4.06719, val_cls_loss: 2.26225, val_prediction_losss: 2.28222, val_diffusion_loss: 0.54388, val_MR: 0.62966, val_minADE1: 15.97778, val_minADE6: 15.96140, val_minFDE1: 31.92846, val_minFDE6: 31.90558
[2025-02-26 18:25:30,096][root][INFO] - 
[Epoch 0] train_loss: 6.46585, train_reg_loss: 3.30263, train_cls_loss: 3.43922, train_prediction_losss: 3.12883, train_diffusion_loss: 1.57626, train_MR: 0.55200, train_minADE1: 15.22572, train_minADE6: 12.99022, train_minFDE1: 30.56639, train_minFDE6: 27.66968
[2025-02-26 20:39:20,247][root][INFO] - 
[Epoch 1] val_loss: 5.48249, val_reg_loss: 4.09522, val_cls_loss: 3.30030, val_prediction_losss: 1.35426, val_diffusion_loss: 0.53541, val_MR: 0.63161, val_minADE1: 16.20963, val_minADE6: 16.14118, val_minFDE1: 32.01945, val_minFDE6: 31.91973
[2025-02-26 20:39:20,257][root][INFO] - 
[Epoch 1] train_loss: 4.49578, train_reg_loss: 2.26497, train_cls_loss: 3.64288, train_prediction_losss: 2.19439, train_diffusion_loss: 2.94984, train_MR: 0.47827, train_minADE1: 14.82230, train_minADE6: 9.73863, train_minFDE1: 29.97822, train_minFDE6: 21.31680
[2025-02-26 23:33:12,915][root][INFO] - 
[Epoch 2] val_loss: 4.82276, val_reg_loss: 4.08123, val_cls_loss: 2.44842, val_prediction_losss: 0.71705, val_diffusion_loss: 0.53245, val_MR: 0.63643, val_minADE1: 16.17478, val_minADE6: 16.15806, val_minFDE1: 31.62510, val_minFDE6: 31.55029
[2025-02-26 23:33:12,924][root][INFO] - 
[Epoch 2] train_loss: 2.32405, train_reg_loss: 1.00088, train_cls_loss: 3.61362, train_prediction_losss: 1.28703, train_diffusion_loss: 4.59355, train_MR: 0.38706, train_minADE1: 11.47436, train_minADE6: 5.24059, train_minFDE1: 23.55350, train_minFDE6: 11.79117
[2025-02-27 02:29:22,441][root][INFO] - 
[Epoch 3] val_loss: 4.40321, val_reg_loss: 3.87907, val_cls_loss: 3.07458, val_prediction_losss: 0.49339, val_diffusion_loss: 0.65321, val_MR: 0.62531, val_minADE1: 15.43010, val_minADE6: 15.31876, val_minFDE1: 30.40215, val_minFDE6: 30.17484
[2025-02-27 02:29:22,449][root][INFO] - 
[Epoch 3] train_loss: 1.17422, train_reg_loss: 0.34869, train_cls_loss: 3.51277, train_prediction_losss: 0.79041, train_diffusion_loss: 5.67517, train_MR: 0.28587, train_minADE1: 10.11950, train_minADE6: 2.98062, train_minFDE1: 20.04289, train_minFDE6: 5.69566
[2025-02-27 05:23:59,434][root][INFO] - 
[Epoch 4] val_loss: 4.18253, val_reg_loss: 3.69674, val_cls_loss: 2.85711, val_prediction_losss: 0.45722, val_diffusion_loss: 0.90182, val_MR: 0.63321, val_minADE1: 14.85553, val_minADE6: 14.72470, val_minFDE1: 28.59629, val_minFDE6: 28.23263
[2025-02-27 05:23:59,446][root][INFO] - 
[Epoch 4] train_loss: 0.90761, train_reg_loss: 0.23570, train_cls_loss: 3.47891, train_prediction_losss: 0.63712, train_diffusion_loss: 5.76907, train_MR: 0.24185, train_minADE1: 9.44303, train_minADE6: 2.64396, train_minFDE1: 18.67933, train_minFDE6: 4.75850
[2025-02-27 08:13:43,913][root][INFO] - 
[Epoch 5] val_loss: 4.31983, val_reg_loss: 3.85088, val_cls_loss: 2.91581, val_prediction_losss: 0.43979, val_diffusion_loss: 0.80535, val_MR: 0.63454, val_minADE1: 15.38177, val_minADE6: 15.28702, val_minFDE1: 27.86635, val_minFDE6: 27.43261
[2025-02-27 08:13:43,940][root][INFO] - 
[Epoch 5] train_loss: 0.82853, train_reg_loss: 0.21164, train_cls_loss: 3.46650, train_prediction_losss: 0.58222, train_diffusion_loss: 5.80818, train_MR: 0.21543, train_minADE1: 9.00968, train_minADE6: 2.51103, train_minFDE1: 17.90278, train_minFDE6: 4.45146
[2025-02-27 10:26:27,831][root][INFO] - 
[Epoch 6] val_loss: 2.81538, val_reg_loss: 2.38876, val_cls_loss: 3.17631, val_prediction_losss: 0.39486, val_diffusion_loss: 2.31002, val_MR: 0.62062, val_minADE1: 9.97095, val_minADE6: 9.74984, val_minFDE1: 23.36704, val_minFDE6: 22.86288
[2025-02-27 10:26:27,839][root][INFO] - 
[Epoch 6] train_loss: 0.78407, train_reg_loss: 0.19977, train_cls_loss: 3.44279, train_prediction_losss: 0.54987, train_diffusion_loss: 5.90532, train_MR: 0.20374, train_minADE1: 8.37453, train_minADE6: 2.47258, train_minFDE1: 16.73816, train_minFDE6: 4.36933
[2025-02-27 12:38:59,440][root][INFO] - 
[Epoch 7] val_loss: 3.40234, val_reg_loss: 2.98003, val_cls_loss: 3.06690, val_prediction_losss: 0.39164, val_diffusion_loss: 1.59546, val_MR: 0.63182, val_minADE1: 12.14964, val_minADE6: 11.90475, val_minFDE1: 25.58526, val_minFDE6: 25.21671
[2025-02-27 12:38:59,448][root][INFO] - 
[Epoch 7] train_loss: 0.74895, train_reg_loss: 0.19081, train_cls_loss: 3.42652, train_prediction_losss: 0.52388, train_diffusion_loss: 6.02559, train_MR: 0.19439, train_minADE1: 8.12038, train_minADE6: 2.37898, train_minFDE1: 16.33289, train_minFDE6: 4.19977
