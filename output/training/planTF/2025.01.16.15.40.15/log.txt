2025-01-16 15:40:17,503 INFO {/data/datasets/niukangjia/plantf/run_training.py:49}  Logger is configured correctly.
2025-01-16 15:40:17,717 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/script/builders/folder_builder.py:20}  Building experiment folders...
2025-01-16 15:40:17,717 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/script/builders/folder_builder.py:22}  Experimental folder: /data/datasets/niukangjia/plantf/output/training/planTF/2025.01.16.15.40.15
2025-01-16 15:40:17,718 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/script/builders/worker_pool_builder.py:19}  Building WorkerPool...
2025-01-16 15:40:17,719 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/utils/multithreading/worker_pool.py:101}  Worker: SingleMachineParallelExecutor
2025-01-16 15:40:17,719 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/utils/multithreading/worker_pool.py:102}  Number of nodes: 1
Number of CPUs per node: 32
Number of GPUs per node: 0
Number of threads across all nodes: 32
2025-01-16 15:40:17,719 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/script/builders/worker_pool_builder.py:27}  Building WorkerPool...DONE!
2025-01-16 15:40:17,719 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_training_builder.py:258}  Building training engine...
2025-01-16 15:40:22,357 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/script/builders/model_builder.py:18}  Building TorchModuleWrapper...
2025-01-16 15:40:23,431 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/script/builders/model_builder.py:21}  Building TorchModuleWrapper...DONE!
2025-01-16 15:40:23,432 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/script/builders/splitter_builder.py:18}  Building Splitter...
2025-01-16 15:40:24,301 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/script/builders/splitter_builder.py:21}  Building Splitter...DONE!
2025-01-16 15:40:24,301 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/script/builders/data_augmentation_builder.py:19}  Building augmentors...
2025-01-16 15:40:24,304 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/script/builders/data_augmentation_builder.py:28}  Building augmentors...DONE!
2025-01-16 15:40:39,533 INFO {/data/datasets/niukangjia/nuplan-devkit/nuplan/planning/script/builders/scenario_builder.py:171}  Extracted 204791 scenarios for training
2025-01-16 15:40:39,538 INFO {/data/datasets/niukangjia/plantf/run_training.py:68}  Starting training...
2025-01-16 15:40:39,573 INFO {/home/ustc/anaconda3/envs/pluto/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:442}  Added key: store_based_barrier_key:1 to store for rank: 0
2025-01-16 15:40:39,585 INFO {/home/ustc/anaconda3/envs/pluto/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py:476}  Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
2025-01-16 15:40:40,024 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_datamodule.py:56}  Number of samples in train set: 132384
2025-01-16 15:40:40,079 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_datamodule.py:56}  Number of samples in validation set: 32407
2025-01-16 15:40:43,326 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_training_builder.py:318}  
[Epoch 0] val_loss: 6.45428, val_reg_loss: 3.89886, val_cls_loss: 1.91929, val_prediction_losss: 2.53623, val_diffusion_loss: 0.00000, val_MR: 0.53125, val_minADE1: 14.53620, val_minADE6: 14.46405, val_minFDE1: 28.18901, val_minFDE6: 27.60147
2025-01-16 15:55:37,162 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_training_builder.py:318}  
[Epoch 0] val_loss: 3.70042, val_reg_loss: 2.05198, val_cls_loss: 0.75348, val_prediction_losss: 1.64091, val_diffusion_loss: 0.00000, val_MR: 0.56577, val_minADE1: 8.91025, val_minADE6: 8.22121, val_minFDE1: 22.77821, val_minFDE6: 21.32652
2025-01-16 15:55:37,171 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_training_builder.py:318}  
[Epoch 0] train_loss: 5.76182, train_reg_loss: 3.14521, train_cls_loss: 0.87205, train_prediction_losss: 2.60788, train_diffusion_loss: 0.00000, train_MR: 0.57150, train_minADE1: 12.78169, train_minADE6: 11.80307, train_minFDE1: 27.64729, train_minFDE6: 26.29328
2025-01-16 16:12:02,354 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_training_builder.py:318}  
[Epoch 1] val_loss: 1.04447, val_reg_loss: 0.38816, val_cls_loss: 1.03450, val_prediction_losss: 0.64596, val_diffusion_loss: 0.00000, val_MR: 0.47184, val_minADE1: 3.80017, val_minADE6: 1.76270, val_minFDE1: 8.99019, val_minFDE6: 4.89243
2025-01-16 16:12:02,364 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_training_builder.py:318}  
[Epoch 1] train_loss: 2.63818, train_reg_loss: 1.27313, train_cls_loss: 1.15900, train_prediction_losss: 1.35346, train_diffusion_loss: 0.00000, train_MR: 0.54337, train_minADE1: 7.89921, train_minADE6: 5.06840, train_minFDE1: 18.82598, train_minFDE6: 13.69364
2025-01-16 16:29:59,985 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_training_builder.py:318}  
[Epoch 2] val_loss: 0.66800, val_reg_loss: 0.23851, val_cls_loss: 1.16724, val_prediction_losss: 0.41782, val_diffusion_loss: 0.00000, val_MR: 0.44732, val_minADE1: 3.02321, val_minADE6: 1.16175, val_minFDE1: 6.35648, val_minFDE6: 2.15805
2025-01-16 16:29:59,997 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_training_builder.py:318}  
[Epoch 2] train_loss: 1.11949, train_reg_loss: 0.40077, train_cls_loss: 1.31518, train_prediction_losss: 0.70557, train_diffusion_loss: 0.00000, train_MR: 0.48822, train_minADE1: 5.36736, train_minADE6: 1.80990, train_minFDE1: 11.26659, train_minFDE6: 3.87082
2025-01-16 16:50:42,094 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_training_builder.py:318}  
[Epoch 3] val_loss: 0.61567, val_reg_loss: 0.20965, val_cls_loss: 1.12582, val_prediction_losss: 0.39477, val_diffusion_loss: 0.00000, val_MR: 0.41397, val_minADE1: 2.27921, val_minADE6: 1.08973, val_minFDE1: 5.11819, val_minFDE6: 2.05202
2025-01-16 16:50:42,106 INFO {/data/datasets/niukangjia/plantf/src/custom_training/custom_training_builder.py:318}  
[Epoch 3] train_loss: 0.87601, train_reg_loss: 0.29595, train_cls_loss: 1.30939, train_prediction_losss: 0.56696, train_diffusion_loss: 0.00000, train_MR: 0.45458, train_minADE1: 4.65465, train_minADE6: 1.43606, train_minFDE1: 9.65934, train_minFDE6: 2.53653
